Possible optimisations: say a requestor sends RdShared, and Host sends SnpData to the owner (in M state), M responds with RspIFwdM. Now we know the requestor will have the sole copy. But the spec says RdShared can only get GO-S/I/Err back, not GO-E.


<h1>Comments for CXL.cache transaction layer specification--clarifications needed</h1>

<!-- This is a comment and will not be rendered in the output. -->

<h2>Table of Contents</h2>
<ul>
  <li><a href="#motivation-for-suggestions">Relevant sections</a></li>
  <li><a href="#mixed-accesses-to-memory-locations">Our understanding of the rules</a></li>
  <li><a href="#release-sequence-and-visible-sequence-of-side-effects">Proposed changes</a></li>
</ul>

<h2>Relevant sections in spec (page 105-106)</h2>

<h3>3.2.5.2 Device/Host Snoop-GO-Data Assumptions</h3>
<!-- This is a comment and will not be rendered in the output. -->
<h3>3.2.5.3 Device/Host Snoop/WritePull Assumptions</h3>
<!-- This is a comment and will not be rendered in the output. -->
<h3>3.2.5.4 Snoop Responses and Data Transfer on CXL.cache Evicts</h3>
<!-- This is a comment and will not be rendered in the output. -->

<h2>Our understanding of the rules and why certain parts are redundant</h2>
<p>Rule 3.2.5.3 on page 106 suggests a type of "atomicity" of evictions and read transactions. By atomicity we mean that any request, be it an eviction or Rd*, once having been serialised at the host, is not allowed to be "interrupted" by another transaction.</p>

<p>...</p> <!-- Additional content abbreviated for brevity, but you can add in the details. -->

<h2>Proposed change 1</h2>
<p>We propose to merge 3.2.5.4 into 3.2.5.3, and delete the second part of 3.2.5.3. The Relevant sections will be reduced to the following (3.2.5.2 included here for self-containedness):</p>

<p>...</p> <!-- Additional content abbreviated for brevity, but you can add in the details. -->

<h2>Needed clarification 1</h2>
<p>For the snoop-pushes-GO rule and "GO not tailgating snoop" rule in 3.2.5.2, how does an H2D Response qualify as a GO? Does "GO" mean "exclusively GO only", and therefore the "GO_WritePull" combined message does not count as "GO"? We suggest treating such a message as a GO, as it simplifies rules 3.2.5.3 and 3.2.5.4.</p>

<!-- This is a comment and will not be rendered in the output. -->

